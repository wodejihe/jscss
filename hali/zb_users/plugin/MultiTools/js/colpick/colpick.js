(function(g){var W=function(){var W='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',c={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:true,flat:false,layout:"full",submit:1,submitText:"OK",height:156},bE=function(W,c){var d=h(W);g(c).data("colpick").fields.eq(1).val(d.r).end().eq(2).val(d.g).end().eq(3).val(d.b).end()},A=function(W,c){g(c).data("colpick").fields.eq(4).val(Math.round(W.h)).end().eq(5).val(Math.round(W.s)).end().eq(6).val(Math.round(W.b)).end()},fE=function(W,c){g(c).data("colpick").fields.eq(0).val(f(W))},dg=function(W,c){g(c).data("colpick").selector.css("backgroundColor","#"+f({h:W.h,s:100,b:100}));g(c).data("colpick").selectorIndic.css({left:parseInt(g(c).data("colpick").height*W.s/100,10),top:parseInt(g(c).data("colpick").height*(100-W.b)/100,10)})},e=function(W,c){g(c).data("colpick").hue.css("top",parseInt(g(c).data("colpick").height-g(c).data("colpick").height*W.h/360,10))},J=function(W,c){g(c).data("colpick").currentColor.css("backgroundColor","#"+f(W))},dR=function(W,c){g(c).data("colpick").newColor.css("backgroundColor","#"+f(W))},a=function(W){var c=g(this).parent().parent(),J;if(this.parentNode.className.indexOf("_hex")>0){c.data("colpick").color=J=d(be(this.value));bE(J,c.get(0));A(J,c.get(0))}else if(this.parentNode.className.indexOf("_hsb")>0){c.data("colpick").color=J=bV({h:parseInt(c.data("colpick").fields.eq(4).val(),10),s:parseInt(c.data("colpick").fields.eq(5).val(),10),b:parseInt(c.data("colpick").fields.eq(6).val(),10)});bE(J,c.get(0));fE(J,c.get(0))}else{c.data("colpick").color=J=b(dB({r:parseInt(c.data("colpick").fields.eq(1).val(),10),g:parseInt(c.data("colpick").fields.eq(2).val(),10),b:parseInt(c.data("colpick").fields.eq(3).val(),10)}));fE(J,c.get(0));A(J,c.get(0))}dg(J,c.get(0));e(J,c.get(0));dR(J,c.get(0));c.data("colpick").onChange.apply(c.parent(),[J,f(J),h(J),c.data("colpick").el,0])},T=function(W){g(this).parent().removeClass("colpick_focus")},fg=function(){g(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus");g(this).parent().addClass("colpick_focus")},df=function(W){W.preventDefault?W.preventDefault():W.returnValue=false;var c=g(this).parent().find("input").focus();var d={el:g(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:W.pageY,field:c,val:parseInt(c.val(),10),preview:g(this).parent().parent().data("colpick").livePreview};g(document).mouseup(d,gC);g(document).mousemove(d,bN)},bN=function(g){g.data.field.val(Math.max(0,Math.min(g.data.max,parseInt(g.data.val-g.pageY+g.data.y,10))));if(g.data.preview){a.apply(g.data.field.get(0),[true])}return false},gC=function(W){a.apply(W.data.field.get(0),[true]);W.data.el.removeClass("colpick_slider").find("input").focus();g(document).off("mouseup",gC);g(document).off("mousemove",bN);return false},ee=function(W){W.preventDefault?W.preventDefault():W.returnValue=false;var c={cal:g(this).parent(),y:g(this).offset().top};g(document).on("mouseup touchend",c,dd);g(document).on("mousemove touchmove",c,de);var d=W.type=="touchstart"?W.originalEvent.changedTouches[0].pageY:W.pageY;a.apply(c.cal.data("colpick").fields.eq(4).val(parseInt(360*(c.cal.data("colpick").height-(d-c.y))/c.cal.data("colpick").height,10)).get(0),[c.cal.data("colpick").livePreview]);return false},de=function(g){var W=g.type=="touchmove"?g.originalEvent.changedTouches[0].pageY:g.pageY;a.apply(g.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(g.data.cal.data("colpick").height-Math.max(0,Math.min(g.data.cal.data("colpick").height,W-g.data.y)))/g.data.cal.data("colpick").height,10)).get(0),[g.data.preview]);return false},dd=function(W){bE(W.data.cal.data("colpick").color,W.data.cal.get(0));fE(W.data.cal.data("colpick").color,W.data.cal.get(0));g(document).off("mouseup touchend",dd);g(document).off("mousemove touchmove",de);return false},fQ=function(W){W.preventDefault?W.preventDefault():W.returnValue=false;var c={cal:g(this).parent(),pos:g(this).offset()};c.preview=c.cal.data("colpick").livePreview;g(document).on("mouseup touchend",c,bD);g(document).on("mousemove touchmove",c,aV);var d,b;if(W.type=="touchstart"){pageX=W.originalEvent.changedTouches[0].pageX,b=W.originalEvent.changedTouches[0].pageY}else{pageX=W.pageX;b=W.pageY}a.apply(c.cal.data("colpick").fields.eq(6).val(parseInt(100*(c.cal.data("colpick").height-(b-c.pos.top))/c.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-c.pos.left)/c.cal.data("colpick").height,10)).get(0),[c.preview]);return false},aV=function(g){var W,c;if(g.type=="touchmove"){pageX=g.originalEvent.changedTouches[0].pageX,c=g.originalEvent.changedTouches[0].pageY}else{pageX=g.pageX;c=g.pageY}a.apply(g.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(g.data.cal.data("colpick").height-Math.max(0,Math.min(g.data.cal.data("colpick").height,c-g.data.pos.top)))/g.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(g.data.cal.data("colpick").height,pageX-g.data.pos.left))/g.data.cal.data("colpick").height,10)).get(0),[g.data.preview]);return false},bD=function(W){bE(W.data.cal.data("colpick").color,W.data.cal.get(0));fE(W.data.cal.data("colpick").color,W.data.cal.get(0));g(document).off("mouseup touchend",bD);g(document).off("mousemove touchmove",aV);return false},dV=function(W){var c=g(this).parent();var d=c.data("colpick").color;c.data("colpick").origColor=d;J(d,c.get(0));c.data("colpick").onSubmit(d,f(d),h(d),c.data("colpick").el)},bR=function(W){W.stopPropagation();var c=g("#"+g(this).data("colpickId"));c.data("colpick").onBeforeShow.apply(this,[c.get(0)]);var d=g(this).offset();var b=d.top+this.offsetHeight;var h=d.left;var bE=ab();var f=c.width();if(h+f>bE.l+bE.w){h-=f}c.css({left:h+"px",top:b+"px"});if(c.data("colpick").onShow.apply(this,[c.get(0)])!=false){c.show()}g("html").mousedown({cal:c},cF);c.mousedown(function(g){g.stopPropagation()})},cF=function(W){if(W.data.cal.data("colpick").onHide.apply(this,[W.data.cal.get(0)])!=false){W.data.cal.hide()}g("html").off("mousedown",cF)},ab=function(){var g=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(g?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(g?document.documentElement.clientWidth:document.body.clientWidth)}},bV=function(g){return{h:Math.min(360,Math.max(0,g.h)),s:Math.min(100,Math.max(0,g.s)),b:Math.min(100,Math.max(0,g.b))}},dB=function(g){return{r:Math.min(255,Math.max(0,g.r)),g:Math.min(255,Math.max(0,g.g)),b:Math.min(255,Math.max(0,g.b))}},be=function(g){var W=6-g.length;if(W>0){var c=[];for(var d=0;d<W;d++){c.push("0")}c.push(g);g=c.join("")}return g},aE=function(){var W=g(this).parent();var c=W.data("colpick").origColor;W.data("colpick").color=c;bE(c,W.get(0));fE(c,W.get(0));A(c,W.get(0));dg(c,W.get(0));e(c,W.get(0));dR(c,W.get(0))};return{init:function(h){h=g.extend({},c,h||{});if(typeof h.color=="string"){h.color=d(h.color)}else if(h.color.r!=undefined&&h.color.g!=undefined&&h.color.b!=undefined){h.color=b(h.color)}else if(h.color.h!=undefined&&h.color.s!=undefined&&h.color.b!=undefined){h.color=bV(h.color)}else{return this}return this.each(function(){if(!g(this).data("colpickId")){var c=g.extend({},h);c.origColor=h.color;var d="collorpicker_"+parseInt(Math.random()*1e3);g(this).data("colpickId",d);var b=g(W).attr("id",d);b.addClass("colpick_"+c.layout+(c.submit?"":" colpick_"+c.layout+"_ns"));if(c.colorScheme!="light"){b.addClass("colpick_"+c.colorScheme)}b.find("div.colpick_submit").html(c.submitText).click(dV);c.fields=b.find("input").change(a).blur(T).focus(fg);b.find("div.colpick_field_arrs").mousedown(df).end().find("div.colpick_current_color").click(aE);c.selector=b.find("div.colpick_color").on("mousedown touchstart",fQ);c.selectorIndic=c.selector.find("div.colpick_selector_outer");c.el=this;c.hue=b.find("div.colpick_hue_arrs");huebar=c.hue.parent();var f=navigator.userAgent.toLowerCase();var bN=navigator.appName==="Microsoft Internet Explorer";var gC=bN?parseFloat(f.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0;var de=bN&&gC<10;var dd=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(de){var aV,bD;for(aV=0;aV<=11;aV++){bD=g("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+dd[aV]+", endColorstr="+dd[aV+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+dd[aV]+", endColorstr="+dd[aV+1]+')";');huebar.append(bD)}}else{stopList=dd.join(",");huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")}b.find("div.colpick_hue").on("mousedown touchstart",ee);c.newColor=b.find("div.colpick_new_color");c.currentColor=b.find("div.colpick_current_color");b.data("colpick",c);bE(c.color,b.get(0));A(c.color,b.get(0));fE(c.color,b.get(0));e(c.color,b.get(0));dg(c.color,b.get(0));J(c.color,b.get(0));dR(c.color,b.get(0));if(c.flat){b.appendTo(this).show();b.css({position:"relative",display:"block"})}else{b.appendTo(document.body);g(this).on(c.showEvent,bR);b.css({position:"absolute"})}}})},showPicker:function(){return this.each(function(){if(g(this).data("colpickId")){bR.apply(this)}})},hidePicker:function(){return this.each(function(){if(g(this).data("colpickId")){g("#"+g(this).data("colpickId")).hide()}})},setColor:function(W,c){c=typeof c==="undefined"?1:c;if(typeof W=="string"){W=d(W)}else if(W.r!=undefined&&W.g!=undefined&&W.b!=undefined){W=b(W)}else if(W.h!=undefined&&W.s!=undefined&&W.b!=undefined){W=bV(W)}else{return this}return this.each(function(){if(g(this).data("colpickId")){var d=g("#"+g(this).data("colpickId"));d.data("colpick").color=W;d.data("colpick").origColor=W;bE(W,d.get(0));A(W,d.get(0));fE(W,d.get(0));e(W,d.get(0));dg(W,d.get(0));dR(W,d.get(0));d.data("colpick").onChange.apply(d.parent(),[W,f(W),h(W),d.data("colpick").el,1]);if(c){J(W,d.get(0))}}})}}}();var c=function(g){var g=parseInt(g.indexOf("#")>-1?g.substring(1):g,16);return{r:g>>16,g:(g&65280)>>8,b:g&255}};var d=function(g){return b(c(g))};var b=function(g){var W={h:0,s:0,b:0};var c=Math.min(g.r,g.g,g.b);var d=Math.max(g.r,g.g,g.b);var b=d-c;W.b=d;W.s=d!=0?255*b/d:0;if(W.s!=0){if(g.r==d)W.h=(g.g-g.b)/b;else if(g.g==d)W.h=2+(g.b-g.r)/b;else W.h=4+(g.r-g.g)/b}else W.h=-1;W.h*=60;if(W.h<0)W.h+=360;W.s*=100/255;W.b*=100/255;return W};var h=function(g){var W={};var c=g.h;var d=g.s*255/100;var b=g.b*255/100;if(d==0){W.r=W.g=W.b=b}else{var h=b;var bE=(255-d)*b/255;var f=(h-bE)*(c%60)/60;if(c==360)c=0;if(c<60){W.r=h;W.b=bE;W.g=bE+f}else if(c<120){W.g=h;W.b=bE;W.r=h-f}else if(c<180){W.g=h;W.r=bE;W.b=bE+f}else if(c<240){W.b=h;W.r=bE;W.g=h-f}else if(c<300){W.b=h;W.g=bE;W.r=bE+f}else if(c<360){W.r=h;W.g=bE;W.b=h-f}else{W.r=0;W.g=0;W.b=0}}return{r:Math.round(W.r),g:Math.round(W.g),b:Math.round(W.b)}};var bE=function(W){var c=[W.r.toString(16),W.g.toString(16),W.b.toString(16)];g.each(c,function(g,W){if(W.length==1){c[g]="0"+W}});return c.join("")};var f=function(g){return bE(h(g))};g.fn.extend({colpick:W.init,colpickHide:W.hidePicker,colpickShow:W.showPicker,colpickSetColor:W.setColor});g.extend({colpick:{rgbToHex:bE,rgbToHsb:b,hsbToHex:f,hsbToRgb:h,hexToHsb:d,hexToRgb:c}})})(jQuery);